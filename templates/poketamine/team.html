<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

<nav class="navbar bg-light">
    <div class="container-md">
      <a text-decoration=none class="navbar-brand" href="/poketamine">Pok√©tamine</a>
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
         <a class="nav-link active" aria-current="page" href="/poketamine/team"><button class="btn btn-light">Go to teams</button></a>
        </li>
      </ul>
      <form class="d-flex" action="/poketamine" role="search">
        <input class="form-control me-2" name="search" type="text" placeholder="Search for a pokemon" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </div>
  </nav>


<script type="text/javascript">

    const removeTeam = async(teamId) => {
        const response = await fetch('/poketamine/removeTeam/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({teamId: teamId})
        });
           if (response.status == 200) {
            alert("team " + teamId + " removed");
            window.location.href = "/poketamine/team";
        }
            else {
                alert("Failed to remove team " + teamId);
            }
    };

    const removePokemon = async(teamId, pokemonId) => {
        const response = await fetch('/poketamine/removePokemon/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({teamId: teamId, pokemonId: pokemonId})
        });
           if (response.status == 200) {
            alert("remove pokemon " + (pokemonId + 1) + " from team " + teamId);
            window.location.href = "/poketamine/team";
        }
            else {
                alert("Failed to remove pokemon " + pokemonId + " from team " + teamId);
            }
    };
</script>
<h1>Teams</h1>
<a href="/poketamine/">
    <button>Back to the list</button>
</a>
{% if teams %}
<ul>
    {% for key, team in teams.items %}
        <li>
            <h2>Team Number: {{ team.teamId }}</h2>
            <button type="button" onclick="removeTeam({ key })">Delete Team</button>
            <ul>
                {% for pokemon in team.pokemons %}
                    <li>
                        <h3>{{ pokemon.name }}</h3>
                        <image src={{ pokemon.image }}></image>
                        <p>Id: {{ pokemon.id }}</p>
                        <p>Types: {{ pokemon.types }}</p>
                        <p>Height: {{ pokemon.height }}</p>
                        <p>Weight: {{ pokemon.weight }}</p>
                        <p>Moves: {{ pokemon.moves }}</p>
                        <button type="button" onclick="removePokemon({team.teamId} , {forloop.counter0} )">Delete Pokemon From Team</button>
                    </li>
                {% endfor %}  
            </ul>
        </li>
    {% endfor %}
    </ul>
{% else %}
    <p>No teams found.</p>
{% endif %}



